# FreeSwitch学习

## 一、常用总结

### 1、常用命令

```
fsctl loglevel [1-7] #设置日志级别
reloadxml #重载xml配置文件
regex 被匹配字符串|正则表达式 #校验正则表达式是否正确，正确为true 错误为false

```



## 二、什么是SIP协议，和Freeswitch是什么关系？

### 1、理解

所谓协议是一种解决双方理解不一致的方法。其他地方的方言各有各自的发音，互相之间理解会有障碍，那么普通话就是一种协议，解决了方言方言之间的理解难度。

**SIP**是什么？Session Initiation Protocol，会话初始化协议，sip协议不仅仅是用在了Freeswitch，任何有会话管理的服务，均可以借鉴和使用SIP协议。

现在用非正式语言介绍一下ssip的协议。

```
在我们日常生活中，我们想要找一个人互相聊天，首先你要找到这个人、你的声音得传递到对方那里，对方能听到你的声音，同时害的要去理解你的语言（方言、语种），帮你定位到对象的第sip，你们两个协商使用英语沟通还是汉语沟通，使用电话设备还是电脑web的是Sip,最终说话的传递及传输介质是rtc。sip协议做的是，能够让你定位到你想聊天的对象，帮你检测你聊天对象是否可达，帮你管理你们通话的会话、状态，帮你结束你们的聊天进程等等。
```

举个例子：

```
你想谈一场跨国恋爱，你在中国，你的心仪对象在日本(OVER，阵亡)
假设你知道你心仪对象的住址门牌号 (有戏)然后你发现你找不到，也过不去(OVER，阵亡)
假设你知道你心仪对象的住址门牌号，然后你也借助了国际力量，分机飞往了日本，然后你发现，对象人家家里设置了门禁系统，(OVER，阵亡)
假设你知道你心仪对象的住址门牌号，然后你也借助了国际力量，分机飞往了日本，然后你发现，然后你有了安全密码，门打开了，你发现你不会日语(OVER，阵亡)
```

那么如何才能顺利的和心意的对象进行沟通交流呢？

你需要知道对方的地址（通信唯一键），你需要奥获得对方是否在线，你需要有对方接受你信号的权限，你还需要拥有和对方理解一致的语言。

**SIP协议中，每一个通信对象，首先都得拥有一个类似邮箱地址的协议IP，如果你心意的对象就在你了解的范围内，你们两个可以直接通过SIP直连，如果你的对象是不在你的接触范围内，你需要邮政公司、外交部机构等等类似场景来告知你如何找到他。找到之后，你们还得约定同一种沟通语言，然后你们才可以愉快的沟通交流。**



使用sngrep来抓包sip协议来解释sip协议的概念。

![image-20230927163101551](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20230927163101551.png) 

其中左边的183.是一端的SIP地址，另一端是172.的sip协议地址，规范写法如下：sip:你的号码@ip:port

![image-20230927164147642](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20230927164147642.png)

 



















































