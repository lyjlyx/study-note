# 计算机网络基础



**对等方式（P2P）**

对等连接，是指两个主机在通信时并不区分哪一个是服务请求方还是服务提供方。

只要两个主机都运行了对等连接软件（P2P软件），它们就可以进行平等的、对等连接通信

双方都可以下载对方已经存储在硬盘中的共享文档。

![image-20220709161252793](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20220709161252793.png) 



### 因特网核心部分介绍

在网络核心部分起特殊作用的是**路由器(router)**





## 网络性能指标之速率

常用的计算机网络性能指标有7个：

**速率、带宽、吞吐量、时延、往返时间、利用率、丢包率**



### 速率

**计算机发送的信号都是以二进制的形式发送出去的**。

**一个二进制数字对应1bit**

**字节：Byte, 一个Byte= 8bit(1B=8b)**

连接在计算机网络上的主机在数字信道上传送比特数据的速率，也称为比特率或数据率

![image-20230901122640761](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20230901122640761.png) 

 1KB = 2^10B = 1024B = 8*1024b

1MB=K.KB=2^10 * 2^10B = 2^20B=8*2^20b = 2^23 b

![image-20230901141857031](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20230901141857031.png) 







### 带宽

在计算机网络中，带宽用来表示网络中某通道传送数据的的能力，因此网络带宽表示在单位时间内网络中的某信道所能通过的“最高数据率”。

M = 10^3*10^3

100Mb= 100 * 10^3*10^3 = 100 * 10^6 bit

单位：b/s（kbs,Mb/s,Gb/s/,Tb/s）

如果要发送100MB（字节）的数据的话就是：100MB/ (100M * 10^6) 





## TCP/IP网络模型有几层

对于同一台设备上的进程间通信，有很多种方式，比如有管道、消息队列、共享内存、信号等方式，而对于不同设备上的进程间通信，就需要网络通信，而设备是多样性的，所以要兼容多种多样的设备，就协商出了一套**通用的网络协议**。

这个网络协议是分层的，每一层都有各自的作用和职责，接下来就根据「 TCP/IP 网络模型」分别对每一层进行介绍。

应用层、传输层、网络层、网络接口层

### 应用层

应用层只需要专注于为用户提供应用功能，类似：HTTP、FTP、Telnet、DNS、SMTP等等。

应用层不需要去关心数据是如何传输的，就类似于寄快递：你只需要把快递交给快递员，由他负责传输，我们不需要关系快递是如何被运输的。



### 传输层

应用层的数据包会传给传输层，**传输层**（*Transport Layer*）是为应用层提供网络支持的。

![image-20240626173616533](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20240626173616533.png) 

传输层中会有两个传输协议分别是TCP、UDP。

TCP的全称叫传输控制协议（*Transmission Control Protocol*），大部分应用使用的正是TCP传输层协议，比如：HTTP应用层协议。TCP相比UDP多了很多特性，比如：流量控制、超时重传、拥塞控制，这些都是为了保证数据包能可靠的传输给对方。

UDP相对来说就比较简单，简单到只负责发送数据包，不保证包是否能够抵达到对方，但他实时性相对更好，传输效率也高。当然，UDP也可以实现可靠的传输，把TCP的特性在应用层上实现就可以，不过要实现一个商用的可靠的UDP传输协议，也不是一个简单的事情。

应用需要传输的数据可能会非常大，如果直接传输就不好控制，因此当传输层的数据包大小超过MSS（TCP最大报文段长度），就要将数据包分块，这样及时中途有一个分块丢失或损坏了，只需要重新发送这一个分块，而不用重新发送整个数据包。在TCP协议中，我们把每个分块称为一个TCP段（*TCP Segment*）

![image-20240626180344989](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20240626180344989.png)

当设备作为接受方时，传输层要负责把数据包传给应用，但是一台设备上可能会有很多应用在接收或者传输数据，因此则需要用一个编号将应用区分开来，这个编号就是端口。

比如80端口通常是Web服务用的，22端口通常是远程登录服务器用的，而对于浏览器(客户端)中的每个标签都是一个独立的进程，操作系统会为这些进程分配临时的端口号。

由于传输层的报文中会携带端口号，因此接收方可以识别出该报文是发送给哪个应用



### 网络层

传输层可能接触的时候会认为他负责将数据从一个设备传输到另一个设备，事实上他并不负责这块的传输。

实际场景之中的网络环节是错综复杂的，中间有各种各样的线路和分岔路口，如果一个设备的数据要传输给另一个设备，就需要各种各样的路劲和节点进行选择，而传输层的设计理念是简单、高效、专注，如果传输层还负责这一块功能就有点违背设计的原则了。

也就是说我们不希望传输层协议处理太多的事情，只需要服务好应用即可，让其作为应用层数据传输的媒介，帮助实现应用到应用的通信，而实际的传输功能就交给下一层，也就是**网络层**(*Internet Layer*)

![image-20240627174520940](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20240627174520940.png)

网络层最常使用的是IP协议(*Internet Protocol*)，IP协议会将传输层的报文作为数据部分，再加上IP包头组装成IP报文，如果IP报文大小超过MTU(以太网中一般为1500字节)就会***再次进行分片***，得到一个即将发送到网络的IP报文。

![image-20240627182543539](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20240627182543539.png)

网络层负责将数据从一个设备传输到另一个设备，世界上那么多的设备，又应该如何找到彼此呢？因此，网络层需要有一个区分设备的编号。

我们一般用IP地址给设备进行编号，对于IPV4协议，IP地址一共32位，分成了四段（比如，192.168.3.1），每段是8位。只有一个单纯的IP地址虽然做到了区分设备，但是寻址起来就会特别麻烦，全世界那么多台设备，难道一个一个区匹配吗？这显然是不行的。

- 一个是*网络号*，负责标识该IP地址是属于哪个[子网]的；
- 一个是*主机号*，负责标识同一子网下的不同主机的；

怎么分的呢？这需要配合*子网掩码*才能算出IP地址的网络和主机号。

举个例子，比如10.100.122.0/24，后面的``24``其实表示的就是``255.255.255.0``子网掩码，255.255.255.0的二进制是[11111111-11111111-11111111-00000000]，这块总共有24个1，为了简化子网掩码的表示，用``/24``代替255.255.255.0

问题来了：

知道了子网掩码，该怎么计算出网络地址的主机地址呢？

将10.100.122.2和255.255.255.0进行**按位与运算**，就可以得到网络号，如下图：

![image-20240628182003222](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20240628182003222.png)

将255.255.255.0取反后与IP地址进行**按位与运算**，就可以得到主机号。

可以上网搜索子网掩码计算器，自己改变下[掩码码]的数值，就能体会到子网掩码的作用了。

![image-20240628183626239](https://lyx-study-note-image.oss-cn-shenzhen.aliyuncs.com/img/image-20240628183626239.png)

那么在寻址的过程中，先匹配相同的网络号(表示要找到同一个子网)，才会去找对应的主机。

除了寻址能力，IP协议还有另一个重要的能力就是**路由**。实际场景中，两台设备并不是用一条网线连接起来的，而是通过很多网关、路由器、交换机等等众多网络设备连接起来的，那么就会行程多条网络的路径，因此当数据包达到一个网络节点，就需要通过路由算法决定下一步的路径。

路由器寻址工作中，就是要找到目标地址的子网，找到目标地址的子网，找到后进而把数据包转发给对应的网络内。



































































































































